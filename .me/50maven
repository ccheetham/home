#!/usr/bin/env zsh

append_path $ME_OPT_DIR/maven/current

alias m='mvn'
alias m32=$ME_OPT_DIR/maven/3.2/bin/mvn
alias m31=$ME_OPT_DIR/maven/3.1/bin/mvn
alias m30=$ME_OPT_DIR/maven/3.0/bin/mvn
alias m22=$ME_OPT_DIR/maven/2.2/bin/mvn

refresh_maven () {
    local instdir=$ME_OPT_DIR/maven
    local disturl=http://archive.apache.org/dist/maven/binaries
    local -a vers
    versions=(3.2.1 3.1.1 3.0.5 2.2.1)

    mkdir -p $instdir
    for version in $versions
    do
        local shortver=${version%.*}
        if [[ ! -h $instdir/current ]] ; then
            echo linking current to $shortver
            (cd $instdir && ln -s $shortver current)
        fi
        if [[ ! -d $instdir/apache-maven-$version ]]
        then
            echo fetching maven dist for version $shortver
            wget -O - $disturl/apache-maven-${version}-bin.tar.gz 2> /dev/null | tar xfz - -C $instdir
        fi
        if [[ ! -e $instdir/$shortver ]]
        then
            echo linking apache-maven-$version to $shortver
            (cd $instdir && ln -s apache-maven-$version $shortver)
        fi
    done
}

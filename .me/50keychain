if which keychain > /dev/null 2>&1 ; then
    shlog using keychain
    keychain --quiet
    export KEYCHAIN_ENV=~/.keychain/$(uname -n)-sh
    [[ -f $KEYCHAIN_ENV ]] && source $KEYCHAIN_ENV
fi

initkeychain() {
    keychain_opts="--eval --agents ssh"
    [[ $ME_DIST_NAME == darwin ]] && keychain_opts+=" --inherit"
    for pub in ~/.ssh/*.pub ; do
        pri=$(basename $pub .pub)
        eval $(keychain $keychain_opts ssh $pri 2> /dev/null)
    done
}

# vim: ft=zsh
